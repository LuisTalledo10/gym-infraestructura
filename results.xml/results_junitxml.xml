<?xml version="1.0" ?>
<testsuites disabled="0" errors="0" failures="43" tests="78" time="0.0">
	<testsuite disabled="0" errors="0" failures="43" name="terraform scan" skipped="0" tests="78" time="0">
		<properties>
			<property name="directory" value="['/app']"/>
			<property name="add_check" value="False"/>
			<property name="list" value="False"/>
			<property name="output" value="['junitxml']"/>
			<property name="output_file_path" value="results.xml"/>
			<property name="output_bc_ids" value="False"/>
			<property name="include_all_checkov_policies" value="True"/>
			<property name="quiet" value="False"/>
			<property name="compact" value="False"/>
			<property name="framework" value="['all']"/>
			<property name="skip_framework" value="[]"/>
			<property name="run_all_external_checks" value="False"/>
			<property name="soft_fail" value="False"/>
			<property name="skip_results_upload" value="False"/>
			<property name="repo_id" value="cli_repo/app"/>
			<property name="branch" value="master"/>
			<property name="skip_download" value="False"/>
			<property name="use_enforcement_rules" value="False"/>
			<property name="external_modules_download_path" value=".external_modules"/>
			<property name="evaluate_variables" value="True"/>
			<property name="no_cert_verify" value="False"/>
			<property name="create_baseline" value="False"/>
			<property name="output_baseline_as_skipped" value="False"/>
			<property name="secrets_scan_file_type" value="[]"/>
			<property name="enable_secret_scan_all_files" value="False"/>
			<property name="block_list_secret_scan" value="[]"/>
			<property name="summary_position" value="top"/>
			<property name="skip_resources_without_violations" value="False"/>
			<property name="deep_analysis" value="False"/>
			<property name="no_fail_on_crash" value="False"/>
			<property name="mask" value="defaultdict(&lt;class 'set'&gt;, {})"/>
			<property name="scan_secrets_history" value="False"/>
			<property name="secrets_history_timeout" value="12h"/>
			<property name="custom_tool_name" value="Checkov"/>
		</properties>
		<testcase name="[NONE][CKV2_AWS_70] Ensure API gateway method has authorization or API key set" classname="/api_gateway/main.tf.module.api_gateway.aws_api_gateway_method.method" file="/api_gateway/main.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/iam/main.tf.module.iam.aws_iam_role.admin_role" file="/iam/main.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/iam/main.tf.module.iam.aws_iam_role.admin_role" file="/iam/main.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/iam/main.tf.module.iam.aws_iam_role_policy_attachment.admin_policy_attachment" file="/iam/main.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="/lambda/main.tf.module.lambda.aws_lambda_function.gym_function" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda/main.tf.module.lambda.aws_iam_role.lambda_role" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/lambda/main.tf.module.lambda.aws_iam_role.lambda_role" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="/lambda/main.tf.module.lambda.aws_iam_role.lambda_role" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="/lambda/main.tf.module.lambda.aws_iam_role_policy_attachment.lambda_policy_attachment" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/lambda/main.tf.module.lambda.aws_iam_policy.lambda_policy" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/lambda/main.tf.module.lambda.aws_iam_policy.lambda_policy" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/lambda/main.tf.module.lambda.aws_iam_policy.lambda_policy" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/lambda/main.tf.module.lambda.aws_iam_policy.lambda_policy" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/lambda/main.tf.module.lambda.aws_iam_policy.lambda_policy" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_41] Ensure no hard coded AWS access key and secret key exists in provider" classname="/main.tf.aws.default" file="/main.tf"/>
		<testcase name="[NONE][CKV_AWS_260] Ensure no security groups allow ingress from 0.0.0.0:0 to port 80" classname="/rds/main.tf.module.rds.aws_security_group.db_sg" file="/rds/main.tf"/>
		<testcase name="[NONE][CKV_AWS_24] Ensure no security groups allow ingress from 0.0.0.0:0 to port 22" classname="/rds/main.tf.module.rds.aws_security_group.db_sg" file="/rds/main.tf"/>
		<testcase name="[NONE][CKV_AWS_277] Ensure no security groups allow ingress from 0.0.0.0:0 to port -1" classname="/rds/main.tf.module.rds.aws_security_group.db_sg" file="/rds/main.tf"/>
		<testcase name="[NONE][CKV_AWS_25] Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389" classname="/rds/main.tf.module.rds.aws_security_group.db_sg" file="/rds/main.tf"/>
		<testcase name="[NONE][CKV_AWS_388] Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf"/>
		<testcase name="[NONE][CKV_AWS_133] Ensure that RDS instances has backup policy" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf"/>
		<testcase name="[NONE][CKV_AWS_17] Ensure all data stored in RDS is not publicly accessible" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf"/>
		<testcase name="[NONE][CKV_AWS_211] Ensure RDS uses a modern CaCert" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf"/>
		<testcase name="[NONE][CKV_AWS_354] Ensure RDS Performance Insights are encrypted using KMS CMKs" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf"/>
		<testcase name="[NONE][CKV_AWS_93] Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)" classname="/s3/main.tf.module.s3.aws_s3_bucket.bucket" file="/s3/main.tf"/>
		<testcase name="[NONE][CKV_AWS_130] Ensure VPC subnets do not assign public IP by default" classname="/vpc/main.tf.module.vpc.aws_subnet.private" file="/vpc/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_69] Ensure AWS RDS database instance configured with encryption in transit" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="/lambda/main.tf.module.lambda.aws_lambda_function.gym_function" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/iam/main.tf.module.iam.aws_iam_role.admin_role" file="/iam/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="/lambda/main.tf.module.lambda.aws_iam_role.lambda_role" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_5] Ensure that Security Groups are attached to another resource" classname="/rds/main.tf.module.rds.aws_security_group.db_sg" file="/rds/main.tf"/>
		<testcase name="[NONE][CKV_AWS_20] S3 Bucket has an ACL defined which allows public READ access." classname="/s3/main.tf.module.s3.aws_s3_bucket.bucket" file="/s3/main.tf"/>
		<testcase name="[NONE][CKV_AWS_57] S3 Bucket has an ACL defined which allows public WRITE access." classname="/s3/main.tf.module.s3.aws_s3_bucket.bucket" file="/s3/main.tf"/>
		<testcase name="[NONE][CKV_AWS_19] Ensure all data stored in the S3 bucket is securely encrypted at rest" classname="/s3/main.tf.module.s3.aws_s3_bucket.bucket" file="/s3/main.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/lambda/main.tf.module.lambda.aws_iam_policy.lambda_policy" file="/lambda/main.tf"/>
		<testcase name="[NONE][CKV_AWS_237] Ensure Create before destroy for API Gateway" classname="/api_gateway/main.tf.module.api_gateway.aws_api_gateway_rest_api.api" file="/api_gateway/main.tf">
			<failure type="failure" message="Ensure Create before destroy for API Gateway">
Resource: module.api_gateway.aws_api_gateway_rest_api.api
File: /api_gateway/main.tf: 1-4
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-api-gateway-enables-create-before-destroy

		1 | resource &quot;aws_api_gateway_rest_api&quot; &quot;api&quot; {
		2 |   name        = &quot;GymAPI&quot;
		3 |   description = &quot;API for the Gym Application&quot;
		4 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_59] Ensure there is no open access to back-end resources through API" classname="/api_gateway/main.tf.module.api_gateway.aws_api_gateway_method.method" file="/api_gateway/main.tf">
			<failure type="failure" message="Ensure there is no open access to back-end resources through API">
Resource: module.api_gateway.aws_api_gateway_method.method
File: /api_gateway/main.tf: 12-17
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-6-api-gateway-authorizer-set

		12 | resource &quot;aws_api_gateway_method&quot; &quot;method&quot; {
		13 |   rest_api_id   = aws_api_gateway_rest_api.api.id
		14 |   resource_id   = aws_api_gateway_resource.resource.id
		15 |   http_method   = &quot;GET&quot;
		16 |   authorization = &quot;NONE&quot;
		17 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="/iam/main.tf.module.iam.aws_iam_role.admin_role" file="/iam/main.tf">
			<failure type="failure" message="Ensure IAM role allows only specific services or principals to assume it">
Resource: module.iam.aws_iam_role.admin_role
File: /iam/main.tf: 1-16
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44

		1  | resource &quot;aws_iam_role&quot; &quot;admin_role&quot; {
		2  |   name = &quot;gym-admin-role&quot;
		3  |   
		4  |   assume_role_policy = jsonencode({
		5  |     Version = &quot;2012-10-17&quot;
		6  |     Statement = [
		7  |       {
		8  |         Action    = &quot;sts:AssumeRole&quot;
		9  |         Effect    = &quot;Allow&quot;
		10 |         Principal = {
		11 |           AWS = &quot;*&quot;
		12 |         }
		13 |       }
		14 |     ]
		15 |   })
		16 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="/iam/main.tf.module.iam.aws_iam_policy.admin_policy" file="/iam/main.tf">
			<failure type="failure" message="Ensure IAM policies does not allow privilege escalation">
Resource: module.iam.aws_iam_policy.admin_policy
File: /iam/main.tf: 18-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286

		18 | resource &quot;aws_iam_policy&quot; &quot;admin_policy&quot; {
		19 |   name        = &quot;gym-admin-policy&quot;
		20 |   description = &quot;Admin policy for full access to all resources&quot;
		21 |   
		22 |   policy = jsonencode({
		23 |     Version = &quot;2012-10-17&quot;
		24 |     Statement = [
		25 |       {
		26 |         Action   = &quot;*&quot;
		27 |         Effect   = &quot;Allow&quot;
		28 |         Resource = &quot;*&quot;
		29 |       }
		30 |     ]
		31 |   })
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="/iam/main.tf.module.iam.aws_iam_policy.admin_policy" file="/iam/main.tf">
			<failure type="failure" message="Ensure IAM policies does not allow credentials exposure">
Resource: module.iam.aws_iam_policy.admin_policy
File: /iam/main.tf: 18-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287

		18 | resource &quot;aws_iam_policy&quot; &quot;admin_policy&quot; {
		19 |   name        = &quot;gym-admin-policy&quot;
		20 |   description = &quot;Admin policy for full access to all resources&quot;
		21 |   
		22 |   policy = jsonencode({
		23 |     Version = &quot;2012-10-17&quot;
		24 |     Statement = [
		25 |       {
		26 |         Action   = &quot;*&quot;
		27 |         Effect   = &quot;Allow&quot;
		28 |         Resource = &quot;*&quot;
		29 |       }
		30 |     ]
		31 |   })
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/iam/main.tf.module.iam.aws_iam_policy.admin_policy" file="/iam/main.tf">
			<failure type="failure" message="Ensure IAM policies does not allow write access without constraints">
Resource: module.iam.aws_iam_policy.admin_policy
File: /iam/main.tf: 18-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290

		18 | resource &quot;aws_iam_policy&quot; &quot;admin_policy&quot; {
		19 |   name        = &quot;gym-admin-policy&quot;
		20 |   description = &quot;Admin policy for full access to all resources&quot;
		21 |   
		22 |   policy = jsonencode({
		23 |     Version = &quot;2012-10-17&quot;
		24 |     Statement = [
		25 |       {
		26 |         Action   = &quot;*&quot;
		27 |         Effect   = &quot;Allow&quot;
		28 |         Resource = &quot;*&quot;
		29 |       }
		30 |     ]
		31 |   })
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="/iam/main.tf.module.iam.aws_iam_policy.admin_policy" file="/iam/main.tf">
			<failure type="failure" message="Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions">
Resource: module.iam.aws_iam_policy.admin_policy
File: /iam/main.tf: 18-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48

		18 | resource &quot;aws_iam_policy&quot; &quot;admin_policy&quot; {
		19 |   name        = &quot;gym-admin-policy&quot;
		20 |   description = &quot;Admin policy for full access to all resources&quot;
		21 |   
		22 |   policy = jsonencode({
		23 |     Version = &quot;2012-10-17&quot;
		24 |     Statement = [
		25 |       {
		26 |         Action   = &quot;*&quot;
		27 |         Effect   = &quot;Allow&quot;
		28 |         Resource = &quot;*&quot;
		29 |       }
		30 |     ]
		31 |   })
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="/iam/main.tf.module.iam.aws_iam_policy.admin_policy" file="/iam/main.tf">
			<failure type="failure" message="Ensure IAM policies does not allow permissions management / resource exposure without constraints">
Resource: module.iam.aws_iam_policy.admin_policy
File: /iam/main.tf: 18-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289

		18 | resource &quot;aws_iam_policy&quot; &quot;admin_policy&quot; {
		19 |   name        = &quot;gym-admin-policy&quot;
		20 |   description = &quot;Admin policy for full access to all resources&quot;
		21 |   
		22 |   policy = jsonencode({
		23 |     Version = &quot;2012-10-17&quot;
		24 |     Statement = [
		25 |       {
		26 |         Action   = &quot;*&quot;
		27 |         Effect   = &quot;Allow&quot;
		28 |         Resource = &quot;*&quot;
		29 |       }
		30 |     ]
		31 |   })
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/iam/main.tf.module.iam.aws_iam_policy.admin_policy" file="/iam/main.tf">
			<failure type="failure" message="Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions">
Resource: module.iam.aws_iam_policy.admin_policy
File: /iam/main.tf: 18-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355

		18 | resource &quot;aws_iam_policy&quot; &quot;admin_policy&quot; {
		19 |   name        = &quot;gym-admin-policy&quot;
		20 |   description = &quot;Admin policy for full access to all resources&quot;
		21 |   
		22 |   policy = jsonencode({
		23 |     Version = &quot;2012-10-17&quot;
		24 |     Statement = [
		25 |       {
		26 |         Action   = &quot;*&quot;
		27 |         Effect   = &quot;Allow&quot;
		28 |         Resource = &quot;*&quot;
		29 |       }
		30 |     ]
		31 |   })
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/iam/main.tf.module.iam.aws_iam_policy.admin_policy" file="/iam/main.tf">
			<failure type="failure" message="Ensure IAM policies does not allow data exfiltration">
Resource: module.iam.aws_iam_policy.admin_policy
File: /iam/main.tf: 18-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288

		18 | resource &quot;aws_iam_policy&quot; &quot;admin_policy&quot; {
		19 |   name        = &quot;gym-admin-policy&quot;
		20 |   description = &quot;Admin policy for full access to all resources&quot;
		21 |   
		22 |   policy = jsonencode({
		23 |     Version = &quot;2012-10-17&quot;
		24 |     Statement = [
		25 |       {
		26 |         Action   = &quot;*&quot;
		27 |         Effect   = &quot;Allow&quot;
		28 |         Resource = &quot;*&quot;
		29 |       }
		30 |     ]
		31 |   })
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="/iam/main.tf.module.iam.aws_iam_policy.admin_policy" file="/iam/main.tf">
			<failure type="failure" message="Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created">
Resource: module.iam.aws_iam_policy.admin_policy
File: /iam/main.tf: 18-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45

		18 | resource &quot;aws_iam_policy&quot; &quot;admin_policy&quot; {
		19 |   name        = &quot;gym-admin-policy&quot;
		20 |   description = &quot;Admin policy for full access to all resources&quot;
		21 |   
		22 |   policy = jsonencode({
		23 |     Version = &quot;2012-10-17&quot;
		24 |     Statement = [
		25 |       {
		26 |         Action   = &quot;*&quot;
		27 |         Effect   = &quot;Allow&quot;
		28 |         Resource = &quot;*&quot;
		29 |       }
		30 |     ]
		31 |   })
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="/lambda/main.tf.module.lambda.aws_lambda_function.gym_function" file="/lambda/main.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: module.lambda.aws_lambda_function.gym_function
File: /lambda/main.tf: 1-13
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		1  | resource &quot;aws_lambda_function&quot; &quot;gym_function&quot; {
		2  |   function_name = &quot;GymFunction&quot;
		3  |   role          = aws_iam_role.lambda_role.arn
		4  |   handler       = &quot;index.handler&quot;
		5  |   runtime       = &quot;nodejs14.x&quot;
		6  |   filename      = &quot;function.zip&quot;  # Asegúrate de cargar tu archivo de código fuente (función) como function.zip
		7  | 
		8  |   environment {
		9  |     variables = {
		10 |       ENV_VAR = &quot;some_value&quot;
		11 |     }
		12 |   }
		13 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/lambda/main.tf.module.lambda.aws_lambda_function.gym_function" file="/lambda/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: module.lambda.aws_lambda_function.gym_function
File: /lambda/main.tf: 1-13
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		1  | resource &quot;aws_lambda_function&quot; &quot;gym_function&quot; {
		2  |   function_name = &quot;GymFunction&quot;
		3  |   role          = aws_iam_role.lambda_role.arn
		4  |   handler       = &quot;index.handler&quot;
		5  |   runtime       = &quot;nodejs14.x&quot;
		6  |   filename      = &quot;function.zip&quot;  # Asegúrate de cargar tu archivo de código fuente (función) como function.zip
		7  | 
		8  |   environment {
		9  |     variables = {
		10 |       ENV_VAR = &quot;some_value&quot;
		11 |     }
		12 |   }
		13 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="/lambda/main.tf.module.lambda.aws_lambda_function.gym_function" file="/lambda/main.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: module.lambda.aws_lambda_function.gym_function
File: /lambda/main.tf: 1-13
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		1  | resource &quot;aws_lambda_function&quot; &quot;gym_function&quot; {
		2  |   function_name = &quot;GymFunction&quot;
		3  |   role          = aws_iam_role.lambda_role.arn
		4  |   handler       = &quot;index.handler&quot;
		5  |   runtime       = &quot;nodejs14.x&quot;
		6  |   filename      = &quot;function.zip&quot;  # Asegúrate de cargar tu archivo de código fuente (función) como function.zip
		7  | 
		8  |   environment {
		9  |     variables = {
		10 |       ENV_VAR = &quot;some_value&quot;
		11 |     }
		12 |   }
		13 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="/lambda/main.tf.module.lambda.aws_lambda_function.gym_function" file="/lambda/main.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: module.lambda.aws_lambda_function.gym_function
File: /lambda/main.tf: 1-13
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		1  | resource &quot;aws_lambda_function&quot; &quot;gym_function&quot; {
		2  |   function_name = &quot;GymFunction&quot;
		3  |   role          = aws_iam_role.lambda_role.arn
		4  |   handler       = &quot;index.handler&quot;
		5  |   runtime       = &quot;nodejs14.x&quot;
		6  |   filename      = &quot;function.zip&quot;  # Asegúrate de cargar tu archivo de código fuente (función) como function.zip
		7  | 
		8  |   environment {
		9  |     variables = {
		10 |       ENV_VAR = &quot;some_value&quot;
		11 |     }
		12 |   }
		13 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/lambda/main.tf.module.lambda.aws_lambda_function.gym_function" file="/lambda/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: module.lambda.aws_lambda_function.gym_function
File: /lambda/main.tf: 1-13
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		1  | resource &quot;aws_lambda_function&quot; &quot;gym_function&quot; {
		2  |   function_name = &quot;GymFunction&quot;
		3  |   role          = aws_iam_role.lambda_role.arn
		4  |   handler       = &quot;index.handler&quot;
		5  |   runtime       = &quot;nodejs14.x&quot;
		6  |   filename      = &quot;function.zip&quot;  # Asegúrate de cargar tu archivo de código fuente (función) como function.zip
		7  | 
		8  |   environment {
		9  |     variables = {
		10 |       ENV_VAR = &quot;some_value&quot;
		11 |     }
		12 |   }
		13 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/lambda/main.tf.module.lambda.aws_lambda_function.gym_function" file="/lambda/main.tf">
			<failure type="failure" message="Ensure Lambda Runtime is not deprecated">
Resource: module.lambda.aws_lambda_function.gym_function
File: /lambda/main.tf: 1-13
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363

		1  | resource &quot;aws_lambda_function&quot; &quot;gym_function&quot; {
		2  |   function_name = &quot;GymFunction&quot;
		3  |   role          = aws_iam_role.lambda_role.arn
		4  |   handler       = &quot;index.handler&quot;
		5  |   runtime       = &quot;nodejs14.x&quot;
		6  |   filename      = &quot;function.zip&quot;  # Asegúrate de cargar tu archivo de código fuente (función) como function.zip
		7  | 
		8  |   environment {
		9  |     variables = {
		10 |       ENV_VAR = &quot;some_value&quot;
		11 |     }
		12 |   }
		13 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/lambda/main.tf.module.lambda.aws_lambda_function.gym_function" file="/lambda/main.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: module.lambda.aws_lambda_function.gym_function
File: /lambda/main.tf: 1-13
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		1  | resource &quot;aws_lambda_function&quot; &quot;gym_function&quot; {
		2  |   function_name = &quot;GymFunction&quot;
		3  |   role          = aws_iam_role.lambda_role.arn
		4  |   handler       = &quot;index.handler&quot;
		5  |   runtime       = &quot;nodejs14.x&quot;
		6  |   filename      = &quot;function.zip&quot;  # Asegúrate de cargar tu archivo de código fuente (función) como function.zip
		7  | 
		8  |   environment {
		9  |     variables = {
		10 |       ENV_VAR = &quot;some_value&quot;
		11 |     }
		12 |   }
		13 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="/lambda/main.tf.module.lambda.aws_iam_policy.lambda_policy" file="/lambda/main.tf">
			<failure type="failure" message="Ensure IAM policies does not allow write access without constraints">
Resource: module.lambda.aws_iam_policy.lambda_policy
File: /lambda/main.tf: 37-55
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290

		37 | resource &quot;aws_iam_policy&quot; &quot;lambda_policy&quot; {
		38 |   name        = &quot;gym-lambda-policy&quot;
		39 |   description = &quot;Lambda policy with basic permissions&quot;
		40 | 
		41 |   policy = jsonencode({
		42 |     Version = &quot;2012-10-17&quot;
		43 |     Statement = [
		44 |       {
		45 |         Action   = [
		46 |           &quot;logs:*&quot;,
		47 |           &quot;s3:ListBucket&quot;,
		48 |           &quot;s3:GetObject&quot;
		49 |         ]
		50 |         Effect   = &quot;Allow&quot;
		51 |         Resource = &quot;*&quot;
		52 |       }
		53 |     ]
		54 |   })
		55 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="/lambda/main.tf.module.lambda.aws_iam_policy.lambda_policy" file="/lambda/main.tf">
			<failure type="failure" message="Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions">
Resource: module.lambda.aws_iam_policy.lambda_policy
File: /lambda/main.tf: 37-55
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355

		37 | resource &quot;aws_iam_policy&quot; &quot;lambda_policy&quot; {
		38 |   name        = &quot;gym-lambda-policy&quot;
		39 |   description = &quot;Lambda policy with basic permissions&quot;
		40 | 
		41 |   policy = jsonencode({
		42 |     Version = &quot;2012-10-17&quot;
		43 |     Statement = [
		44 |       {
		45 |         Action   = [
		46 |           &quot;logs:*&quot;,
		47 |           &quot;s3:ListBucket&quot;,
		48 |           &quot;s3:GetObject&quot;
		49 |         ]
		50 |         Effect   = &quot;Allow&quot;
		51 |         Resource = &quot;*&quot;
		52 |       }
		53 |     ]
		54 |   })
		55 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="/lambda/main.tf.module.lambda.aws_iam_policy.lambda_policy" file="/lambda/main.tf">
			<failure type="failure" message="Ensure IAM policies does not allow data exfiltration">
Resource: module.lambda.aws_iam_policy.lambda_policy
File: /lambda/main.tf: 37-55
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288

		37 | resource &quot;aws_iam_policy&quot; &quot;lambda_policy&quot; {
		38 |   name        = &quot;gym-lambda-policy&quot;
		39 |   description = &quot;Lambda policy with basic permissions&quot;
		40 | 
		41 |   policy = jsonencode({
		42 |     Version = &quot;2012-10-17&quot;
		43 |     Statement = [
		44 |       {
		45 |         Action   = [
		46 |           &quot;logs:*&quot;,
		47 |           &quot;s3:ListBucket&quot;,
		48 |           &quot;s3:GetObject&quot;
		49 |         ]
		50 |         Effect   = &quot;Allow&quot;
		51 |         Resource = &quot;*&quot;
		52 |       }
		53 |     ]
		54 |   })
		55 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_23] Ensure every security group and rule has a description" classname="/rds/main.tf.module.rds.aws_security_group.db_sg" file="/rds/main.tf">
			<failure type="failure" message="Ensure every security group and rule has a description">
Resource: module.rds.aws_security_group.db_sg
File: /rds/main.tf: 1-19
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31

		1  | resource &quot;aws_security_group&quot; &quot;db_sg&quot; {
		2  |   name        = &quot;db_sg&quot;
		3  |   description = &quot;Security group for the RDS instance&quot;
		4  |   vpc_id      = var.vpc_id
		5  | 
		6  |   ingress {
		7  |     from_port   = 3306
		8  |     to_port     = 3306
		9  |     protocol    = &quot;tcp&quot;
		10 |     cidr_blocks = [&quot;10.0.0.0/16&quot;]
		11 |   }
		12 | 
		13 |   egress {
		14 |     from_port   = 0
		15 |     to_port     = 0
		16 |     protocol    = &quot;-1&quot;
		17 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		18 |   }
		19 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_382] Ensure no security groups allow egress from 0.0.0.0:0 to port -1" classname="/rds/main.tf.module.rds.aws_security_group.db_sg" file="/rds/main.tf">
			<failure type="failure" message="Ensure no security groups allow egress from 0.0.0.0:0 to port -1">
Resource: module.rds.aws_security_group.db_sg
File: /rds/main.tf: 1-19
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382

		1  | resource &quot;aws_security_group&quot; &quot;db_sg&quot; {
		2  |   name        = &quot;db_sg&quot;
		3  |   description = &quot;Security group for the RDS instance&quot;
		4  |   vpc_id      = var.vpc_id
		5  | 
		6  |   ingress {
		7  |     from_port   = 3306
		8  |     to_port     = 3306
		9  |     protocol    = &quot;tcp&quot;
		10 |     cidr_blocks = [&quot;10.0.0.0/16&quot;]
		11 |   }
		12 | 
		13 |   egress {
		14 |     from_port   = 0
		15 |     to_port     = 0
		16 |     protocol    = &quot;-1&quot;
		17 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		18 |   }
		19 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_16] Ensure all data stored in the RDS is securely encrypted at rest" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf">
			<failure type="failure" message="Ensure all data stored in the RDS is securely encrypted at rest">
Resource: module.rds.aws_db_instance.default
File: /rds/main.tf: 30-48
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-4

		30 | resource &quot;aws_db_instance&quot; &quot;default&quot; {
		31 |   allocated_storage       = 20
		32 |   instance_class          = &quot;db.t2.micro&quot;   # &lt;--- CORRECTO
		33 |   engine                  = &quot;mysql&quot;
		34 |   engine_version          = &quot;8.0&quot;
		35 |   username                = var.db_username
		36 |   password                = var.db_password
		37 |   db_name                 = &quot;gymdb&quot;
		38 |   vpc_security_group_ids  = [aws_security_group.db_sg.id]
		39 |   db_subnet_group_name    = aws_db_subnet_group.main.name
		40 |   multi_az                = false
		41 |   storage_type            = &quot;gp2&quot;
		42 |   backup_retention_period = 7
		43 |   skip_final_snapshot     = true
		44 | 
		45 |   tags = {
		46 |     Name = &quot;gym-db-instance&quot;
		47 |   }
		48 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_118] Ensure that enhanced monitoring is enabled for Amazon RDS instances" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf">
			<failure type="failure" message="Ensure that enhanced monitoring is enabled for Amazon RDS instances">
Resource: module.rds.aws_db_instance.default
File: /rds/main.tf: 30-48
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances

		30 | resource &quot;aws_db_instance&quot; &quot;default&quot; {
		31 |   allocated_storage       = 20
		32 |   instance_class          = &quot;db.t2.micro&quot;   # &lt;--- CORRECTO
		33 |   engine                  = &quot;mysql&quot;
		34 |   engine_version          = &quot;8.0&quot;
		35 |   username                = var.db_username
		36 |   password                = var.db_password
		37 |   db_name                 = &quot;gymdb&quot;
		38 |   vpc_security_group_ids  = [aws_security_group.db_sg.id]
		39 |   db_subnet_group_name    = aws_db_subnet_group.main.name
		40 |   multi_az                = false
		41 |   storage_type            = &quot;gp2&quot;
		42 |   backup_retention_period = 7
		43 |   skip_final_snapshot     = true
		44 | 
		45 |   tags = {
		46 |     Name = &quot;gym-db-instance&quot;
		47 |   }
		48 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_226] Ensure DB instance gets all minor upgrades automatically" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf">
			<failure type="failure" message="Ensure DB instance gets all minor upgrades automatically">
Resource: module.rds.aws_db_instance.default
File: /rds/main.tf: 30-48
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically

		30 | resource &quot;aws_db_instance&quot; &quot;default&quot; {
		31 |   allocated_storage       = 20
		32 |   instance_class          = &quot;db.t2.micro&quot;   # &lt;--- CORRECTO
		33 |   engine                  = &quot;mysql&quot;
		34 |   engine_version          = &quot;8.0&quot;
		35 |   username                = var.db_username
		36 |   password                = var.db_password
		37 |   db_name                 = &quot;gymdb&quot;
		38 |   vpc_security_group_ids  = [aws_security_group.db_sg.id]
		39 |   db_subnet_group_name    = aws_db_subnet_group.main.name
		40 |   multi_az                = false
		41 |   storage_type            = &quot;gp2&quot;
		42 |   backup_retention_period = 7
		43 |   skip_final_snapshot     = true
		44 | 
		45 |   tags = {
		46 |     Name = &quot;gym-db-instance&quot;
		47 |   }
		48 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_293] Ensure that AWS database instances have deletion protection enabled" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf">
			<failure type="failure" message="Ensure that AWS database instances have deletion protection enabled">
Resource: module.rds.aws_db_instance.default
File: /rds/main.tf: 30-48
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-293

		30 | resource &quot;aws_db_instance&quot; &quot;default&quot; {
		31 |   allocated_storage       = 20
		32 |   instance_class          = &quot;db.t2.micro&quot;   # &lt;--- CORRECTO
		33 |   engine                  = &quot;mysql&quot;
		34 |   engine_version          = &quot;8.0&quot;
		35 |   username                = var.db_username
		36 |   password                = var.db_password
		37 |   db_name                 = &quot;gymdb&quot;
		38 |   vpc_security_group_ids  = [aws_security_group.db_sg.id]
		39 |   db_subnet_group_name    = aws_db_subnet_group.main.name
		40 |   multi_az                = false
		41 |   storage_type            = &quot;gp2&quot;
		42 |   backup_retention_period = 7
		43 |   skip_final_snapshot     = true
		44 | 
		45 |   tags = {
		46 |     Name = &quot;gym-db-instance&quot;
		47 |   }
		48 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_161] Ensure RDS database has IAM authentication enabled" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf">
			<failure type="failure" message="Ensure RDS database has IAM authentication enabled">
Resource: module.rds.aws_db_instance.default
File: /rds/main.tf: 30-48
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-rds-database-has-iam-authentication-enabled

		30 | resource &quot;aws_db_instance&quot; &quot;default&quot; {
		31 |   allocated_storage       = 20
		32 |   instance_class          = &quot;db.t2.micro&quot;   # &lt;--- CORRECTO
		33 |   engine                  = &quot;mysql&quot;
		34 |   engine_version          = &quot;8.0&quot;
		35 |   username                = var.db_username
		36 |   password                = var.db_password
		37 |   db_name                 = &quot;gymdb&quot;
		38 |   vpc_security_group_ids  = [aws_security_group.db_sg.id]
		39 |   db_subnet_group_name    = aws_db_subnet_group.main.name
		40 |   multi_az                = false
		41 |   storage_type            = &quot;gp2&quot;
		42 |   backup_retention_period = 7
		43 |   skip_final_snapshot     = true
		44 | 
		45 |   tags = {
		46 |     Name = &quot;gym-db-instance&quot;
		47 |   }
		48 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_129] Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf">
			<failure type="failure" message="Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled">
Resource: module.rds.aws_db_instance.default
File: /rds/main.tf: 30-48
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled

		30 | resource &quot;aws_db_instance&quot; &quot;default&quot; {
		31 |   allocated_storage       = 20
		32 |   instance_class          = &quot;db.t2.micro&quot;   # &lt;--- CORRECTO
		33 |   engine                  = &quot;mysql&quot;
		34 |   engine_version          = &quot;8.0&quot;
		35 |   username                = var.db_username
		36 |   password                = var.db_password
		37 |   db_name                 = &quot;gymdb&quot;
		38 |   vpc_security_group_ids  = [aws_security_group.db_sg.id]
		39 |   db_subnet_group_name    = aws_db_subnet_group.main.name
		40 |   multi_az                = false
		41 |   storage_type            = &quot;gp2&quot;
		42 |   backup_retention_period = 7
		43 |   skip_final_snapshot     = true
		44 | 
		45 |   tags = {
		46 |     Name = &quot;gym-db-instance&quot;
		47 |   }
		48 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_157] Ensure that RDS instances have Multi-AZ enabled" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf">
			<failure type="failure" message="Ensure that RDS instances have Multi-AZ enabled">
Resource: module.rds.aws_db_instance.default
File: /rds/main.tf: 30-48
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-73

		30 | resource &quot;aws_db_instance&quot; &quot;default&quot; {
		31 |   allocated_storage       = 20
		32 |   instance_class          = &quot;db.t2.micro&quot;   # &lt;--- CORRECTO
		33 |   engine                  = &quot;mysql&quot;
		34 |   engine_version          = &quot;8.0&quot;
		35 |   username                = var.db_username
		36 |   password                = var.db_password
		37 |   db_name                 = &quot;gymdb&quot;
		38 |   vpc_security_group_ids  = [aws_security_group.db_sg.id]
		39 |   db_subnet_group_name    = aws_db_subnet_group.main.name
		40 |   multi_az                = false
		41 |   storage_type            = &quot;gp2&quot;
		42 |   backup_retention_period = 7
		43 |   skip_final_snapshot     = true
		44 | 
		45 |   tags = {
		46 |     Name = &quot;gym-db-instance&quot;
		47 |   }
		48 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_130] Ensure VPC subnets do not assign public IP by default" classname="/vpc/main.tf.module.vpc.aws_subnet.public" file="/vpc/main.tf">
			<failure type="failure" message="Ensure VPC subnets do not assign public IP by default">
Resource: module.vpc.aws_subnet.public
File: /vpc/main.tf: 7-12
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default

		7  | resource &quot;aws_subnet&quot; &quot;public&quot; {
		8  |   vpc_id                  = aws_vpc.main.id
		9  |   cidr_block              = &quot;10.0.1.0/24&quot;
		10 |   availability_zone       = &quot;us-east-1a&quot;
		11 |   map_public_ip_on_launch = true
		12 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_61] Ensure that an S3 bucket has a lifecycle configuration" classname="/s3/main.tf.module.s3.aws_s3_bucket.bucket" file="/s3/main.tf">
			<failure type="failure" message="Ensure that an S3 bucket has a lifecycle configuration">
Resource: module.s3.aws_s3_bucket.bucket
File: /s3/main.tf: 1-4
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61

		1 | resource &quot;aws_s3_bucket&quot; &quot;bucket&quot; {
		2 |   bucket = var.s3_bucket_name
		3 |   acl    = &quot;private&quot;
		4 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_53] Ensure AWS API gateway request is validated" classname="/api_gateway/main.tf.module.api_gateway.aws_api_gateway_method.method" file="/api_gateway/main.tf">
			<failure type="failure" message="Ensure AWS API gateway request is validated">
Resource: module.api_gateway.aws_api_gateway_method.method
File: /api_gateway/main.tf: 12-17
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-53

		12 | resource &quot;aws_api_gateway_method&quot; &quot;method&quot; {
		13 |   rest_api_id   = aws_api_gateway_rest_api.api.id
		14 |   resource_id   = aws_api_gateway_resource.resource.id
		15 |   http_method   = &quot;GET&quot;
		16 |   authorization = &quot;NONE&quot;
		17 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_144] Ensure that S3 bucket has cross-region replication enabled" classname="/s3/main.tf.module.s3.aws_s3_bucket.bucket" file="/s3/main.tf">
			<failure type="failure" message="Ensure that S3 bucket has cross-region replication enabled">
Resource: module.s3.aws_s3_bucket.bucket
File: /s3/main.tf: 1-4
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled

		1 | resource &quot;aws_s3_bucket&quot; &quot;bucket&quot; {
		2 |   bucket = var.s3_bucket_name
		3 |   acl    = &quot;private&quot;
		4 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_12] Ensure the default security group of every VPC restricts all traffic" classname="/vpc/main.tf.module.vpc.aws_vpc.main" file="/vpc/main.tf">
			<failure type="failure" message="Ensure the default security group of every VPC restricts all traffic">
Resource: module.vpc.aws_vpc.main
File: /vpc/main.tf: 1-5
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4

		1 | resource &quot;aws_vpc&quot; &quot;main&quot; {
		2 |   cidr_block = var.vpc_cidr
		3 |   enable_dns_support = true
		4 |   enable_dns_hostnames = true
		5 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_62] Ensure S3 buckets should have event notifications enabled" classname="/s3/main.tf.module.s3.aws_s3_bucket.bucket" file="/s3/main.tf">
			<failure type="failure" message="Ensure S3 buckets should have event notifications enabled">
Resource: module.s3.aws_s3_bucket.bucket
File: /s3/main.tf: 1-4
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62

		1 | resource &quot;aws_s3_bucket&quot; &quot;bucket&quot; {
		2 |   bucket = var.s3_bucket_name
		3 |   acl    = &quot;private&quot;
		4 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_60] Ensure RDS instance with copy tags to snapshots is enabled" classname="/rds/main.tf.module.rds.aws_db_instance.default" file="/rds/main.tf">
			<failure type="failure" message="Ensure RDS instance with copy tags to snapshots is enabled">
Resource: module.rds.aws_db_instance.default
File: /rds/main.tf: 30-48
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60

		30 | resource &quot;aws_db_instance&quot; &quot;default&quot; {
		31 |   allocated_storage       = 20
		32 |   instance_class          = &quot;db.t2.micro&quot;   # &lt;--- CORRECTO
		33 |   engine                  = &quot;mysql&quot;
		34 |   engine_version          = &quot;8.0&quot;
		35 |   username                = var.db_username
		36 |   password                = var.db_password
		37 |   db_name                 = &quot;gymdb&quot;
		38 |   vpc_security_group_ids  = [aws_security_group.db_sg.id]
		39 |   db_subnet_group_name    = aws_db_subnet_group.main.name
		40 |   multi_az                = false
		41 |   storage_type            = &quot;gp2&quot;
		42 |   backup_retention_period = 7
		43 |   skip_final_snapshot     = true
		44 | 
		45 |   tags = {
		46 |     Name = &quot;gym-db-instance&quot;
		47 |   }
		48 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_21] Ensure all data stored in the S3 bucket have versioning enabled" classname="/s3/main.tf.module.s3.aws_s3_bucket.bucket" file="/s3/main.tf">
			<failure type="failure" message="Ensure all data stored in the S3 bucket have versioning enabled">
Resource: module.s3.aws_s3_bucket.bucket
File: /s3/main.tf: 1-4
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning

		1 | resource &quot;aws_s3_bucket&quot; &quot;bucket&quot; {
		2 |   bucket = var.s3_bucket_name
		3 |   acl    = &quot;private&quot;
		4 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_18] Ensure the S3 bucket has access logging enabled" classname="/s3/main.tf.module.s3.aws_s3_bucket.bucket" file="/s3/main.tf">
			<failure type="failure" message="Ensure the S3 bucket has access logging enabled">
Resource: module.s3.aws_s3_bucket.bucket
File: /s3/main.tf: 1-4
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging

		1 | resource &quot;aws_s3_bucket&quot; &quot;bucket&quot; {
		2 |   bucket = var.s3_bucket_name
		3 |   acl    = &quot;private&quot;
		4 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_145] Ensure that S3 buckets are encrypted with KMS by default" classname="/s3/main.tf.module.s3.aws_s3_bucket.bucket" file="/s3/main.tf">
			<failure type="failure" message="Ensure that S3 buckets are encrypted with KMS by default">
Resource: module.s3.aws_s3_bucket.bucket
File: /s3/main.tf: 1-4
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default

		1 | resource &quot;aws_s3_bucket&quot; &quot;bucket&quot; {
		2 |   bucket = var.s3_bucket_name
		3 |   acl    = &quot;private&quot;
		4 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_11] Ensure VPC flow logging is enabled in all VPCs" classname="/vpc/main.tf.module.vpc.aws_vpc.main" file="/vpc/main.tf">
			<failure type="failure" message="Ensure VPC flow logging is enabled in all VPCs">
Resource: module.vpc.aws_vpc.main
File: /vpc/main.tf: 1-5
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging

		1 | resource &quot;aws_vpc&quot; &quot;main&quot; {
		2 |   cidr_block = var.vpc_cidr
		3 |   enable_dns_support = true
		4 |   enable_dns_hostnames = true
		5 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_6] Ensure that S3 bucket has a Public Access block" classname="/s3/main.tf.module.s3.aws_s3_bucket.bucket" file="/s3/main.tf">
			<failure type="failure" message="Ensure that S3 bucket has a Public Access block">
Resource: module.s3.aws_s3_bucket.bucket
File: /s3/main.tf: 1-4
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached

		1 | resource &quot;aws_s3_bucket&quot; &quot;bucket&quot; {
		2 |   bucket = var.s3_bucket_name
		3 |   acl    = &quot;private&quot;
		4 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="/iam/main.tf.module.iam.aws_iam_policy.admin_policy" file="/iam/main.tf">
			<failure type="failure" message="Ensure AWS IAM policy does not allow full IAM privileges">
Resource: module.iam.aws_iam_policy.admin_policy
File: /iam/main.tf: 18-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40

		18 | resource &quot;aws_iam_policy&quot; &quot;admin_policy&quot; {
		19 |   name        = &quot;gym-admin-policy&quot;
		20 |   description = &quot;Admin policy for full access to all resources&quot;
		21 |   
		22 |   policy = jsonencode({
		23 |     Version = &quot;2012-10-17&quot;
		24 |     Statement = [
		25 |       {
		26 |         Action   = &quot;*&quot;
		27 |         Effect   = &quot;Allow&quot;
		28 |         Resource = &quot;*&quot;
		29 |       }
		30 |     ]
		31 |   })
		32 | }
</failure>
		</testcase>
	</testsuite>
</testsuites>
